<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>MongoDB的读写操作(3)</title>
      <link href="/2022/04/13/MongoDB%E7%9A%84%E4%BF%AE%E6%94%B9%E6%93%8D%E4%BD%9C%EF%BC%884%EF%BC%89/"/>
      <url>/2022/04/13/MongoDB%E7%9A%84%E4%BF%AE%E6%94%B9%E6%93%8D%E4%BD%9C%EF%BC%884%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="实验4-MongoDB的修改操作"><a href="#实验4-MongoDB的修改操作" class="headerlink" title="实验4 MongoDB的修改操作"></a>实验4 MongoDB的修改操作</h1><h2 id="1-数据更新（update"><a href="#1-数据更新（update" class="headerlink" title="1 数据更新（update)"></a>1 数据更新（update)</h2><p><strong>运算符：$set（教材P46）、 $inc、 $unset 、$rename</strong></p><p>（1）将年龄是19岁的人成绩都更新为100分</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.updateMany(&#123;&quot;age&quot;:<span class="number">19</span>&#125;,&#123;&quot;$set&quot;:&#123;&quot;score&quot;:<span class="number">100</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><p>（2）将所有年龄是20岁的人的成绩修改为99分</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.updateMany(&#123;&quot;age&quot;:<span class="number">20</span>&#125;,&#123;&quot;$set&quot;:&#123;&quot;score&quot;:<span class="number">99</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><p>（3）将所有年龄为19岁的成绩一律减少30分，年龄减小1岁</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.updateMany(&#123;&quot;age&quot;:<span class="number">20</span>&#125;,&#123;&quot;$inc&quot;:&#123;&quot;score&quot;:<span class="number">-30</span>,&quot;age&quot;:<span class="number">-1</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><p><strong>（4）删除“张三”的年龄与成绩信息</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.updateMany(&#123;&quot;name&quot;:&quot;张三&quot;&#125;,&#123;&quot;$upset&quot;: &#123;&quot;age&quot;: <span class="number">1</span>,&quot;score&quot;: <span class="number">1</span>,&quot;course&quot;: <span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure><p>（5）将年龄是30岁的人姓名更新为“不存在” </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.update(&#123;&quot;age&quot;:<span class="number">30</span>&#125;,&#123;&quot;$set&quot;:&#123;&quot;name&quot;:&quot;不存在&quot;&#125;&#125;,<span class="literal">true</span>,<span class="literal">false</span>)</span><br></pre></td></tr></table></figure><p>（6）将“张三”name成员名称修改为“姓名”</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.update(&#123;&quot;name&quot;:&quot;张三&quot;&#125;,&#123;&quot;$rename&quot;:&#123;&quot;name&quot;:&quot;姓名&quot;&#125;&#125;,<span class="literal">false</span>,<span class="literal">false</span>)</span><br></pre></td></tr></table></figure><p>运算符：**$push、$addToSet、$pop、$pull、$pullAll**</p><p>（7）向“谷大神-E”里面的课程追加一个“美术”</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.update(&#123;&quot;name&quot;:&quot;谷大神-E&quot;&#125;,&#123;&quot;$push&quot;:&#123;&quot;course&quot;:&quot;美术&quot;&#125;&#125;)</span><br></pre></td></tr></table></figure><p>（8）向“王五”的信息里面添加多个课程内容：美术、音乐、体育</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.update(&#123;&quot;name&quot;:&quot;王五&quot;&#125;,&#123;&quot;$push&quot;:&#123;&quot;course&quot;:&#123;&quot;$each&quot;:[&quot;美术&quot;,&quot;音乐&quot;,&quot;体育&quot;]&#125;&#125;&#125;)</span><br></pre></td></tr></table></figure><p>（9）向“王五”的信息添加新的内容：course为舞蹈</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.students.update(&#123;&quot;name&quot;:&quot;王五&quot;&#125;,&#123;&quot;$push&quot;:&#123;&quot;course&quot;:&quot;舞蹈&quot;&#125;&#125;)</span><br><span class="line"></span><br><span class="line"># 同为添加 addToSet 但是可以去重</span><br><span class="line">db.students.update(&#123;&quot;name&quot;:&quot;王五&quot;&#125;,&#123;&quot;$addToSet&quot;:&#123;&quot;course&quot;:&quot;舞蹈&quot;&#125;&#125;)</span><br></pre></td></tr></table></figure><p>（10）删除“王五”的第一个课程</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.update(&#123;&quot;name&quot;:&quot;王五&quot;&#125;,&#123;&quot;$pop&quot;:&#123;&quot;course&quot;:<span class="number">-1</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><p>（11）删除“王五”的最后一个课程</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.update(&#123;&quot;name&quot;:&quot;王五&quot;&#125;,&#123;&quot;$pop&quot;:&#123;&quot;course&quot;:<span class="number">1</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><p>（12）删除“王五”的音乐课程信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.update(&#123;&quot;name&quot;:&quot;王五&quot;&#125;,&#123;&quot;$push&quot;:&#123;&quot;course&quot;:&quot;音乐&quot;&#125;&#125;)</span><br></pre></td></tr></table></figure><p>（13）删除“漓江-C”的“语文”和“数学”两门课程</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.update(&#123;&quot;name&quot;:&quot;漓江-C&quot;&#125;,&#123;&quot;$pullAll&quot;:&#123;&quot;course&quot;:[&quot;语文&quot;,&quot;数学&quot;]]&#125;&#125;)</span><br></pre></td></tr></table></figure><h2 id="2-数据删除（delete）"><a href="#2-数据删除（delete）" class="headerlink" title="2 数据删除（delete）"></a>2 数据删除（delete）</h2><p>正则复习</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;name&quot;: <span class="operator">/</span>漓江<span class="operator">/</span>&#125;)                                # 简洁</span><br><span class="line">db.students.find(&#123;&quot;name&quot;:&#123;&quot;$regex&quot;: <span class="operator">/</span>漓江<span class="operator">/</span>,&quot;$options&quot;:&quot;m&quot;&#125;&#125;)        # 详细</span><br></pre></td></tr></table></figure><p>（1）删除所有姓名里面带“谷”的信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.deleteMany(&#123;&quot;name&quot;:<span class="operator">/</span>谷<span class="operator">/</span>&#125;)</span><br></pre></td></tr></table></figure><p>（2）删除姓名带“漓江”的信息，要求只删除一个</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.deldteOne(&#123;&quot;name&quot;:&#123;&quot;regex&quot;:<span class="operator">/</span>漓江<span class="operator">/</span>,&quot;$options&quot;:&quot;m&quot;&#125;&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> MongoDB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MongoDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MongoDB的读写操作(1)</title>
      <link href="/2022/04/13/MongoDB%E7%9A%84%E8%AF%BB%E5%86%99%E6%93%8D%E4%BD%9C%EF%BC%881%EF%BC%89/"/>
      <url>/2022/04/13/MongoDB%E7%9A%84%E8%AF%BB%E5%86%99%E6%93%8D%E4%BD%9C%EF%BC%881%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="实验2-MongoDB的读写操作（1）"><a href="#实验2-MongoDB的读写操作（1）" class="headerlink" title="实验2 MongoDB的读写操作（1）"></a>实验2 MongoDB的读写操作（1）</h1><h2 id="1-数据增加"><a href="#1-数据增加" class="headerlink" title="1 数据增加"></a>1 数据增加</h2><p>（1）在infos集合中增加一条url为 <a href="http://www.ljc.cn/">www.ljc.cn</a> 的数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.infos.insert(&#123;&quot;url&quot;:&quot;www.ljc.cn&quot;&#125;)</span><br></pre></td></tr></table></figure><p>（2）在infos集合中增加数组数据，数组有两个url分别为 <a href="http://www.ljc.cn和www.ljclg.cn的数据/">www.ljc.cn和www.ljclg.cn的数据</a></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.infos.insert(&#123;&quot;url&quot;:[&quot;www.ljc.cn&quot;,&quot;www.ljclg.cn&quot;]&#125;)</span><br></pre></td></tr></table></figure><p>（3）在infos集合中增加10000个url分别为 ljc-1、ljc-2、ljc-3……的数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(var i<span class="operator">=</span><span class="number">1</span>; i<span class="operator">&lt;=</span><span class="number">10000</span>; i<span class="operator">+</span><span class="operator">+</span>)&#123;</span><br><span class="line">db.infos.insert(&#123;&quot;url&quot;:&quot;ljc-&quot;<span class="operator">+</span>i&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-数据查询"><a href="#2-数据查询" class="headerlink" title="2 数据查询"></a>2 数据查询</h2><p>（1）查出集合infos中的所有数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.infos.find()</span><br></pre></td></tr></table></figure><p>（2）查出url为 <a href="http://www.ljc.cn的数据/">www.ljc.cn的数据</a></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.infos.find(&#123;&quot;url&quot;:&quot;www.ljc.cn&quot;&#125;)</span><br></pre></td></tr></table></figure><p>（3）查出url为 <a href="http://www.ljc.cn的数据,但不显示“_id”/">www.ljc.cn的数据，但不显示“_id”</a></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.infos.find(&#123;&quot;url&quot;:&quot;www.ljc.cn&quot;&#125;,&#123;&quot;_id&quot;:<span class="number">0</span>&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>数据：</p><p>db.students.insert({“name”:”张三”,”sex”:”男”,”age”:19,”score”:89,”address”:”海淀区”})</p><p>db.students.insert({“name”:”李四”,”sex”:”女”,”age”:20,”score”:59,”address”:”朝阳区”})</p><p>db.students.insert({“name”:”王五”,”sex”:”女”,”age”:19,”score”:99,”address”:”西城区”})</p><p>db.students.insert({“name”:”赵六”,”sex”:”男”,”age”:20,”score”:100,”address”:”东城区”})</p><p>db.students.insert({“name”:”孙七”,”sex”:”男”,”age”:19,”score”:20,”address”:”海淀区”})</p><p>db.students.insert({“name”:”王八”,”sex”:”女”,”age”:21,”score”:0,”address”:”三里屯”})</p><p>db.students.insert({“name”:”刘九”,”sex”:”男”,”age”:19,”score”:70,”address”:”朝阳区”})</p><p>db.students.insert({“name”:”钱十”,”sex”:”女”,”age”:21,”score”:56,”address”:”西城区”})</p></blockquote><p> <strong>运算符： 大于($gt)、小于($lt)、大于等于($gte)、小于等于($lte)、不等于($ne)、</strong></p><p><strong>等于（key : value的形式）</strong></p><p>（4）查询姓名是张三的学生信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;name&quot;:&quot;张三&quot;&#125;)</span><br></pre></td></tr></table></figure><p>（5）查询性别是男的学生信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;sex&quot;:&quot;男&quot;&#125;)</span><br></pre></td></tr></table></figure><p>（6）查询年龄大于19岁的学生</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;age&quot;:&#123;&quot;$gt&quot;:<span class="number">19</span>&#125;&#125;) </span><br></pre></td></tr></table></figure><p>（7）查询成绩大于60分的学生</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;score&quot;:&#123;&quot;$gt&quot;:<span class="number">60</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><p>（8）查询姓名不是王五的</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;name&quot;:&#123;&quot;$in&quot;:&quot;王五&quot;&#125;&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> MongoDB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MongoDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MongoDB的读写操作(4)</title>
      <link href="/2022/04/13/MongoDB%E7%9A%84%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%EF%BC%885%EF%BC%89/"/>
      <url>/2022/04/13/MongoDB%E7%9A%84%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C%EF%BC%885%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="实验5-MongoDB聚合"><a href="#实验5-MongoDB聚合" class="headerlink" title="实验5 MongoDB聚合"></a>实验5 MongoDB聚合</h1><p><strong>以下操作请使用聚合运算符实现，用到的数据是“emp”集合。</strong></p><p>（1）查询每个职位的人数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.emp.aggregate([</span><br><span class="line">    &#123;&quot;$group&quot; : &#123;&quot;_id&quot; : &quot;$job&quot;,</span><br><span class="line">                &quot;job_people_sum&quot; : &#123;&quot;$sum&quot;:<span class="number">1</span>&#125;&#125;&#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure><p>（2）查询每个职位的总工资</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.emp.aggregate([</span><br><span class="line">    &#123;&quot;$group&quot; : &#123;&quot;_id&quot; : &quot;$job&quot;,</span><br><span class="line">                &quot;job_people_sum&quot; : &#123;&quot;$sum&quot;:<span class="number">1</span>&#125;&#125;&#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure><p>（3）查询每个职位的总工资 ，平均工资</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.emp.aggregate([</span><br><span class="line">    &#123;&quot;$group&quot; : &#123;&quot;_id&quot; : &quot;$job&quot;,</span><br><span class="line">                &quot;job_salary_sum&quot; : &#123;&quot;$sum&quot;:&quot;$salary&quot;&#125;,&quot;job_salary_avg&quot; : &#123;&quot;$avg&quot;:&quot;$salary&quot;&#125;&#125;&#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure><p>（4）查询每个职位的最高工资 ，最低工资</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.emp.aggregate([</span><br><span class="line">    &#123;&quot;$group&quot; : &#123;&quot;_id&quot; : &quot;$job&quot;,</span><br><span class="line">                &quot;job_salary_max&quot; : &#123;&quot;$max&quot;:&quot;$salary&quot;&#125;,&quot;job_salary_min&quot; : &#123;&quot;$min&quot;:&quot;$salary&quot;&#125;&#125;&#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure><p>（5）查询出每个职位的工资数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.emp.aggregate([</span><br><span class="line">    &#123;&quot;$group&quot; : &#123;&quot;_id&quot; : &quot;$job&quot;,</span><br><span class="line">                 &quot;job_salary&quot; : &#123;&quot;$push&quot;:&quot;$salary&quot;&#125;&#125;&#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure><p>（6）查询每个职位的人员</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.emp.aggregate([</span><br><span class="line">    &#123;&quot;$group&quot; : &#123;&quot;_id&quot; : &quot;$job&quot;,</span><br><span class="line">                 &quot;job_name&quot; : &#123;&quot;$push&quot;:&quot;$name&quot;&#125;&#125;&#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure><p>（7）查询每个职位的人员 只保留第一个名称</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.emp.aggregate([</span><br><span class="line">    &#123;&quot;$group&quot; : &#123;&quot;_id&quot; : &quot;$job&quot;,</span><br><span class="line">                 &quot;first_name&quot; : &#123;&quot;$first&quot;:&quot;$name&quot;&#125;&#125;&#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure><p>（8）查询每个职位的人员 只保留最后一个名称</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.emp.aggregate([</span><br><span class="line">    &#123;&quot;$group&quot; : &#123;&quot;_id&quot; : &quot;$job&quot;,</span><br><span class="line">                 &quot;last_name&quot; : &#123;&quot;$last&quot;:&quot;$name&quot;&#125;&#125;&#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure><p>（9）只显示name，job成员，不显示“_id”</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># find做法</span><br><span class="line">db.emp.find(&#123;&#125;,&#123;&quot;_id&quot;:<span class="number">0</span>,&quot;name&quot;:<span class="number">1</span>,&quot;job&quot;:<span class="number">1</span>&#125;)</span><br><span class="line"></span><br><span class="line"># project做法</span><br><span class="line">db.emp.aggregate([</span><br><span class="line">    &#123;&quot;$project&quot;:&#123;&quot;_id&quot;:<span class="number">0</span>,&quot;name&quot;:<span class="number">1</span>,&quot;job&quot;:<span class="number">1</span>&#125;&#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure><p>（10）查询每个人员的年薪，显示name，job和年薪，不显示“_id”（<strong>提示：年薪的计算需要使用$multiply</strong>）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.emp.aggregate([</span><br><span class="line">    &#123;&quot;$match&quot;:&#123;&quot;salary&quot;:&#123;&quot;$gt&quot;:<span class="number">2000</span>&#125;&#125;&#125;,</span><br><span class="line">    &#123;&quot;$project&quot;:&#123;&quot;_id&quot;:<span class="number">0</span>,&quot;name&quot;:<span class="number">1</span>,&quot;job&quot;:<span class="number">1</span>,&quot;salary&quot;:<span class="number">1</span>,&quot;Annual salary&quot;:&#123;&quot;$multiply&quot;:[&quot;$salary&quot;, <span class="number">12</span>]&#125;&#125;&#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure><p>（11）找出工资大于2000的所有雇员姓名、年龄、工资</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.emp.aggregate([</span><br><span class="line">    &#123;&quot;$match&quot;:&#123;&quot;salary&quot;:&#123;&quot;$gt&quot;:<span class="number">2000</span>&#125;&#125;&#125;,</span><br><span class="line">    &#123;&quot;$project&quot;:&#123;&quot;_id&quot;:<span class="number">0</span>,&quot;name&quot;:<span class="number">1</span>,&quot;job&quot;:<span class="number">1</span>,&quot;salary&quot;:<span class="number">1</span>&#125;&#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> MongoDB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MongoDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MongoDB的读写操作(2)</title>
      <link href="/2022/04/13/MongoDB%E7%9A%84%E8%AF%BB%E5%86%99%E6%93%8D%E4%BD%9C%EF%BC%882%EF%BC%89/"/>
      <url>/2022/04/13/MongoDB%E7%9A%84%E8%AF%BB%E5%86%99%E6%93%8D%E4%BD%9C%EF%BC%882%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="MongoDB的读写操作（2）"><a href="#MongoDB的读写操作（2）" class="headerlink" title="MongoDB的读写操作（2）"></a>MongoDB的读写操作（2）</h1><h2 id="运算符：与-and-、或（-or）、非-not、-nor"><a href="#运算符：与-and-、或（-or）、非-not、-nor" class="headerlink" title="运算符：与($and)、或（$or）、非($not、$nor)"></a>运算符：与($and)、或（$or）、非($not、$nor)</h2><p><strong>（用法可参考教材P156）</strong></p><p>（1）查询年龄在19-20岁的学生信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;$and&quot;:[&#123;&quot;age&quot;:&#123;&quot;$gte&quot;:<span class="number">19</span>&#125;&#125;,&#123;&quot;age&quot;:&#123;&quot;$lte&quot;:<span class="number">20</span>&#125;&#125;]&#125;)        <span class="operator">/</span><span class="operator">/</span>显式表示</span><br><span class="line"></span><br><span class="line">db.students.find(&#123;&quot;age&quot;:&#123;&quot;$gte&quot;:<span class="number">19</span>&#125;,&quot;age&quot;:&#123;&quot;$lte&quot;:<span class="number">20</span>&#125;&#125;)                        <span class="operator">/</span><span class="operator">/</span>隐式表示</span><br></pre></td></tr></table></figure><p>（2）查询年龄大于19岁，或者成绩大于90分的学生信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;$or&quot;:[&#123;&quot;age&quot;:&#123;&quot;$gt&quot;:<span class="number">19</span>&#125;&#125;,&#123;&quot;score&quot;: &#123;&quot;$gt&quot;:<span class="number">90</span>&#125;&#125;]&#125;)</span><br></pre></td></tr></table></figure><p>（3）查询年龄小于等于19岁，并且成绩小于等于90分的学生信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;$and&quot;:[&#123;&quot;age&quot;:&#123;&quot;$lte&quot;:<span class="number">19</span>&#125;&#125;,&#123;&quot;score&quot;: &#123;&quot;$lte&quot;:<span class="number">90</span>&#125;&#125;]&#125;)</span><br></pre></td></tr></table></figure><h2 id="运算符：-in-和-nin"><a href="#运算符：-in-和-nin" class="headerlink" title="运算符：$in 和 $nin"></a>运算符：$in 和 $nin</h2><p>（4）查询姓名是“张三”、“李四”、“王五”的信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;name&quot;:&#123;&quot;$in&quot;:[&quot;张三&quot;,&quot;李四&quot;,&quot;王五&quot;]&#125;&#125;)</span><br></pre></td></tr></table></figure><p>（5）查询姓名不是“张三”、“李四”、“王五”的信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;name&quot;:&#123;&quot;$nin&quot;:[&quot;张三&quot;,&quot;李四&quot;,&quot;王五&quot;]&#125;&#125;)</span><br></pre></td></tr></table></figure><h2 id="模糊查询：通过正则表达式实现"><a href="#模糊查询：通过正则表达式实现" class="headerlink" title="模糊查询：通过正则表达式实现"></a>模糊查询：通过正则表达式实现</h2><p>（6）查询姓名带谷字的同学信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;name&quot;:<span class="operator">/</span>谷<span class="operator">/</span>&#125;)</span><br></pre></td></tr></table></figure><p>（7）查询姓名含有字符A或者a的同学信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;name&quot;:<span class="operator">/</span>a<span class="operator">/</span>i&#125;)</span><br></pre></td></tr></table></figure><p>（8）按照成绩进行升序排序</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find().sort(&#123;&quot;score&quot;:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure><p>（9）按成绩降序排序，只显示第一页的5条数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find().sort(&#123;&quot;score&quot;:<span class="number">-1</span>&#125;).limit(<span class="number">5</span>)</span><br></pre></td></tr></table></figure><p><strong>（10）按成绩降序排序，5条数据一页，要求只显示第二页的数据</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find().sort(&#123;&quot;score&quot;:<span class="number">-1</span>&#125;).<span class="keyword">skip</span>(<span class="number">5</span>).limit(<span class="number">5</span>)    <span class="operator">/</span><span class="operator">/</span><span class="keyword">skip</span>(<span class="number">5</span>)跳过五条数据</span><br></pre></td></tr></table></figure><h2 id="运算符：-all、-size、-slice、-elemMatch"><a href="#运算符：-all、-size、-slice、-elemMatch" class="headerlink" title="运算符：$all、$size、$slice、$elemMatch"></a>运算符：$all、$size、$slice、$elemMatch</h2><p><strong>（用法可参考教材P167-172）</strong></p><p>（11）查询同时参加语文和数学课程的学生</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;$and&quot;:[&#123;&quot;course&quot;:&quot;语文&quot;&#125;,&#123;&quot;course&quot;:&quot;数学&quot;&#125;]&#125;)</span><br><span class="line"></span><br><span class="line">db.students.find(&#123;&quot;course&quot;:&#123;&quot;$all&quot;:[&quot;语文&quot;,&quot;数学&quot;]&#125;&#125;)</span><br></pre></td></tr></table></figure><p>（12）查询数组中第二个内容为数学的信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;course.1&quot;:&quot;数学&quot;&#125;)</span><br></pre></td></tr></table></figure><p>（13）查询只参加两门课的学生</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;course&quot;:&#123;&quot;$size&quot;:<span class="number">2</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><p>**（14）返回年龄为19岁所有学生的信息，但是要求只显示两门参加课程 **</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;age&quot;:<span class="number">19</span>&#125;,&#123;&quot;course&quot;:&#123;&quot;$slice&quot;:<span class="number">2</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><p><strong>（15）查询出年龄大于等于19岁，父母有人是局长的学生信息</strong> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;age&quot;:&#123;&quot;$gt&quot;:<span class="number">19</span>&#125;,&quot;parents&quot;:&#123;&quot;$elemMatch&quot;:&#123;&quot;job&quot;:&quot;局长&quot;&#125;&#125;&#125;)</span><br></pre></td></tr></table></figure><h2 id="运算符：-exists-判断某个字段是否存在，如果设置为true表示存在"><a href="#运算符：-exists-判断某个字段是否存在，如果设置为true表示存在" class="headerlink" title="运算符：$exists 判断某个字段是否存在，如果设置为true表示存在"></a>运算符：$exists 判断某个字段是否存在，如果设置为true表示存在</h2><p>（16）查询具有parents成员的数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;parents&quot;:&#123;&quot;$exists&quot;: <span class="literal">true</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><p>（17）查询不具有course成员的数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.students.find(&#123;&quot;course&quot;:&#123;&quot;$exists&quot;: <span class="literal">false</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><p><strong>下期预告</strong></p><p>删除修改，python结合巩固</p>]]></content>
      
      
      <categories>
          
          <category> MongoDB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MongoDB </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
